
<?php
error_reporting(E_ALL);
ini_set('display_errors', '1');

session_start();

// Проверяем, был ли отправлен POST-запрос
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Проверяем наличие CSRF-токена
    if (!empty($_POST['csrf_token'])) {
        // Проверяем, соответствует ли токен сохраненному значению в сессии
        if ($_POST['csrf_token'] === $_SESSION['csrf_token']) {
            // Токен верен, продолжаем обработку формы

            // Добавьте ваш код обработки формы здесь

            // Очищаем токен после использования
            unset($_SESSION['csrf_token']);
        } else {
            // Неверный токен, возможно, атака CSRF
            die('Ошибка: Неверный токен CSRF');
        }
    } else {
        // Ошибка: CSRF-токен отсутствует
        die('Ошибка: CSRF-токен отсутствует');
    }
} else {
    // Ошибка: Эта страница должна обрабатывать только POST-запросы
    die('Ошибка: Неверный метод запроса');
}
?>
